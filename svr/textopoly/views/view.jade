script(type='text/javascript')
  var params=!{JSON.stringify(params)}; 
div.grid#map(class='z'+params.zoom)
  each txt in texts
    if txt.t
      if( params.zoom < 20)
        div.msg(data-coords=txt.p,style='left:#{txt.absx}px;top:#{txt.absy}px;',class=txt.s,id='x'+(8000+txt.p[0])+'y'+(8000+txt.p[1])) 
          p #{txt.t} 
          div.coord (#{txt.p})
      else
        div.msg(data-coords=txt.p,style='left:#{txt.absx}px;top:#{txt.absy}px;background-color:#{txt.c};',class=txt.s,id='x'+(8000+txt.p[0])+'y'+(8000+txt.p[1]))
    else
      div.msg(data-coords=txt.p,style='left:#{txt.absx}px;top:#{txt.absy}px;background-color:#{txt.c};',class=txt.s,id='x'+(8000+txt.p[0])+'y'+(8000+txt.p[1]))
        p.author #{txt.a}